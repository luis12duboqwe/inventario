
<svg xmlns="http://www.w3.org/2000/svg" width="960" height="600" viewBox="0 0 960 600">
  <defs>
    <style>
      .box { fill: #0f172a; stroke: #38bdf8; stroke-width: 3; rx: 18; ry: 18; }
      .box-alt { fill: #111827; stroke: #38bdf8; stroke-width: 3; rx: 18; ry: 18; }
      .box-light { fill: #1f2937; stroke: #38bdf8; stroke-width: 3; rx: 18; ry: 18; }
      .title { fill: #38bdf8; font-family: 'Segoe UI', sans-serif; font-size: 28px; font-weight: 700; }
      .label { fill: #e2e8f0; font-family: 'Segoe UI', sans-serif; font-size: 20px; font-weight: 600; }
      .text { fill: #f8fafc; font-family: 'Segoe UI', sans-serif; font-size: 18px; }
      .bullet { fill: #bae6fd; font-size: 18px; font-weight: 700; }
      .arrow { stroke: #38bdf8; stroke-width: 4; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#38bdf8" />
    </marker>
  </defs>
  <rect width="960" height="600" fill="#020617" rx="32" ry="32" />
  <text x="480" y="60" class="title" text-anchor="middle">Flujo del sistema de registro y autenticación</text>

  <rect x="60" y="120" width="280" height="140" class="box-light" />
  <text x="200" y="170" class="label" text-anchor="middle">Interfaz de acceso</text>
  <text x="200" y="205" class="text" text-anchor="middle">LoginScene · BootstrapForm</text>

  <rect x="360" y="120" width="240" height="140" class="box-alt" />
  <text x="480" y="170" class="label" text-anchor="middle">API REST /auth</text>
  <text x="480" y="205" class="text" text-anchor="middle">FastAPI + dependencias</text>

  <rect x="630" y="120" width="270" height="140" class="box" />
  <text x="765" y="165" class="label" text-anchor="middle">Capa CRUD y auditoría</text>
  <text x="765" y="200" class="text" text-anchor="middle">Sesiones, tokens, 2FA, logs</text>

  <rect x="60" y="300" width="320" height="220" class="box-light" />
  <text x="220" y="350" class="label" text-anchor="middle">Base de datos</text>
  <text x="220" y="385" class="text" text-anchor="middle">users · active_sessions · password_reset_tokens</text>
  <text x="220" y="415" class="text" text-anchor="middle">logs_sistema · audit_logs</text>

  <rect x="400" y="300" width="500" height="220" class="box" />
  <text x="650" y="345" class="label" text-anchor="middle">Acciones principales</text>
  <text x="430" y="380" class="bullet">•</text>
  <text x="450" y="380" class="text">/auth/bootstrap/status comprueba si existe algún usuario.</text>
  <text x="430" y="410" class="bullet">•</text>
  <text x="450" y="410" class="text">/auth/bootstrap crea la cuenta administradora inicial (roles forzados a ADMIN).</text>
  <text x="430" y="440" class="bullet">•</text>
  <text x="450" y="440" class="text">/auth/token emite JWT y registra la sesión activa.</text>
  <text x="430" y="470" class="bullet">•</text>
  <text x="450" y="470" class="text">/auth/session genera cookie segura con vigencia configurable.</text>
  <text x="430" y="500" class="bullet">•</text>
  <text x="450" y="500" class="text">/auth/password/* orquesta solicitud y confirmación de recuperación.</text>

  <line x1="340" y1="190" x2="360" y2="190" class="arrow" />
  <line x1="600" y1="190" x2="630" y2="190" class="arrow" />
  <line x1="200" y1="260" x2="200" y2="300" class="arrow" />
  <line x1="480" y1="260" x2="480" y2="300" class="arrow" />
  <line x1="765" y1="260" x2="765" y2="300" class="arrow" />
</svg>
